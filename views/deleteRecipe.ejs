<!DOCTYPE html>
<%- include("partials/header", { title: "Delete Recipe", studentId }) %>

<h1 class="text-danger mb-4">Delete Recipe</h1>

<% if (msg) { %>
  <div class="alert alert-warning"><%= msg %></div>
<% } %>

<!-- Select recipe -->
<form class="mb-4" method="GET" action="/delete-recipe-<%= studentId %>">
  <div class="row g-2 align-items-end">
    <div class="col-md-6">
      <label class="form-label">Select Recipe</label>
      <select name="recipeId" class="form-select" onchange="this.form.submit()">
        <% recipes.forEach(r => { %>
          <option value="<%= r.recipeId %>" <%= (selected && selected.recipeId === r.recipeId) ? "selected" : "" %>>
            <%= r.recipeId %> — <%= r.title %>
          </option>
        <% }) %>
      </select>
    </div>
    <div class="col-md-3">
      <a class="btn btn-secondary w-100" href="/recipes-<%= studentId %>">⬅ Back to Recipes</a>
    </div>
  </div>
</form>

<!-- Preview -->
<% if (selected) { %>
  <div class="card border-danger mb-3">
    <div class="card-header bg-danger text-white">
      <strong><%= selected.title %></strong>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <p><strong>Recipe ID:</strong> <%= selected.recipeId %></p>
          <p><strong>Chef:</strong> <%= selected.chef %></p>
          <p><strong>Meal:</strong> <%= selected.mealType %></p>
          <p><strong>Cuisine:</strong> <%= selected.cuisineType %></p>
        </div>
        <div class="col-md-6">
          <p><strong>Difficulty:</strong> <%= selected.difficulty %></p>
          <p><strong>Prep Time:</strong> <%= selected.prepTime %> min</p>
          <p><strong>Servings:</strong> <%= selected.servings %></p>
        </div>
      </div>
      <hr>
      <p class="text-danger mb-2"><strong>This recipe will be permanently deleted.</strong></p>

      <form method="POST" action="/api/delete-recipe-<%= studentId %>">
        <input type="hidden" name="recipeId" value="<%= selected.recipeId %>">
        <div class="form-check my-2">
          <input class="form-check-input" type="checkbox" name="confirm" id="confirmDelete">
          <label class="form-check-label" for="confirmDelete">
            I understand this action cannot be undone.
          </label>
        </div>
        <div class="d-flex gap-2 mt-3">
          <button type="submit" class="btn btn-danger">Delete Recipe</button>
          <a href="/recipes-<%= studentId %>" class="btn btn-outline-secondary">Cancel</a>
        </div>
      </form>
    </div>
  </div>
<% } %>

<%- include("partials/footer") %>
